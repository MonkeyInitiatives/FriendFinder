<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pirate Finder | Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
    crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
    crossorigin="anonymous"></script>
    
    <style>
        #myVideo {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%; 
            min-height: 100%;
            z-index: -1;
        }
        .modal-body{
            display: block;
        }
        img{
            max-height: 160px;
        }
        .form{
            background-color: #282E34;
            color: #ddd;
            padding: 20px;
        }
        .btn{
            background-color: #227959;
            color: #ddd;
        }

    </style>
</head>
<body>
<audio id="player" autoplay loop><source src="audio/backgroundaudio.mp3" type="audio/mp3"></audio>
<video autoplay muted loop id="myVideo">
    <source src="/video/backgroundvideo.mp4" type="video/mp4">
</video>
<div class="container">
    <div class="form">
        <h1>Survey Questions</h1>
        <h2>About You</h2>
        <div class="form-group">
            <label for="exampleName">Name (Required)</label>
            <input type="text" class="form-control" id="name" required>
        </div>
        <div class="form-group">
            <label for="pwd">Link to Photo Image (Required)</label>
            <input type="text" class="form-control" id="photolink" required>
        </div>
        <h3>Question 1</h3>
        <div class="form-group">
            <label for="inputState">You  love to plunder the seas of riches and wealth.</label>
            <select id="inputState1" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 2</h3>
        <div class="form-group">
            <label for="inputState">Nothing beats drinking a hearty mug of grog at the end of the day.</label>
            <select id="inputState2" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 3</h3>
        <div class="form-group">
            <label for="inputState">Even a pirate should be cultured and a patron of the arts.</label>
            <select id="inputState3" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 4</h3>
        <div class="form-group">
            <label for="inputState">You are most at peace sailing the seas.</label>
            <select id="inputState4" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 5</h3>
        <div class="form-group">
            <label for="inputState">Treasure hunting should be banned.</label>
            <select id="inputState5" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 6</h3>
        <div class="form-group">
            <label for="inputState">It is often difficult for you to relate to other peopleâ€™s feelings.</label>
            <select id="inputState6" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 7</h3>
        <div class="form-group">
            <label for="inputState">Parrots make the best pets.</label>
            <select id="inputState7" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 8</h3>
        <div class="form-group">
            <label for="inputState">Piracy is not the same as running a business.</label>
            <select id="inputState8" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 9</h3>
        <div class="form-group">
            <label for="inputState">Monkeys are scary.</label>
            <select id="inputState9" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <h3>Question 10</h3>
        <div class="form-group">
            <label for="inputState">A pirate's life is for me.</label>
            <select id="inputState10" class="form-control" style="width: 155px;" required>
                <option selected>Select an Option</option>
                <option>1 (Strongly Disagree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Agree)</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit" data-target="#results-modal"><i class="fa fa-check-circle" aria-hidden="true"></i>
            Submit</button>
    </div>
    <div class="container">
        <p><a href="/api/friendsdata">API Pirate List</a> | <a href="https://github.com/MonkeyInitiatives/FriendFinder">GitHub Repo</a></p>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" id="results-modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Best Match</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h3 id="best-match"></h3>
                </div>
                <div class="modal-body">
                    <span id="best-image"></span>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>    
<script>

$( "#submit" ).click(function() {
    event.preventDefault();
    var falseFlag = false;
    if($('#name').val().trim()==="")
    {
        falseFlag=true;
    }
    if($('#photolink').val().trim()==="")
    {
        falseFlag=true;
    }
    if($('#photolink').val().trim().match(/\.(jpeg|jpg|gif|png)$/) == null)
    {
        falseFlag=true;
    }
    
    for(var i = 1; i<11; i++){
        if($('#inputState'+i).val()==="Select an Option"){
            falseFlag=true;
        }
    }
    if(falseFlag){
        $("#best-match").empty();
        $("#best-image").empty();
        $("#best-match").text("Please fill out the entire form correctly!");
        $('#results-modal').modal('show');
    }
    else{
        var newFriend = {
                name: $('#name').val().trim(),
                photo: $('#photolink').val().trim(),
                scores: [parseInt($('#inputState1').val()[0]),parseInt($('#inputState2').val()[0]),parseInt($('#inputState3').val()[0]),parseInt($('#inputState4').val()[0]),parseInt($('#inputState5').val()[0]),parseInt($('#inputState6').val()[0]),parseInt($('#inputState7').val()[0]),parseInt($('#inputState8').val()[0]),parseInt($('#inputState9').val()[0]),parseInt($('#inputState10').val()[0])]
            };
            // console.log(newFriend);
        $.post("/api/friendsdata", newFriend)
        .then(function(data) {
            $("#best-match").empty();
            $("#best-image").empty();
            $("#best-match").text(data.name+"\n");
            $("#best-image").append('<img id="theImg" src='+data.photo+' />');
            $('#results-modal').modal('show');
            });
    }
});

</script>
</body>
</html>